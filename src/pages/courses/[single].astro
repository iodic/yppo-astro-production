---
import Base from "@/layouts/Base.astro"
import BlogSingle from "@/layouts/BlogSingle.astro"

import { i18nConfig } from "@/i18n/i18nConfig"
import { sanityFetch } from "@/lib/utils/sanityFetch"

export async function getStaticPaths() {
  const { defaultLocale } = i18nConfig

  const posts = await sanityFetch({ type: "course", lang: defaultLocale, query: "featured != false", pipe: "order(_createdAt desc)" })

  const paths = posts.map((post: any) => ({
    params: {
      single: post.slug.current
    },
    props: { post }
  }))
  return paths
}

const { post } = Astro.props
const { title, description, image } = post
---

<Base title={title} description={description} image={image}>
  <BlogSingle post={post} />
</Base>
