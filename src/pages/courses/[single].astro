---
import { sanityFetch } from "@/lib/utils/sanityFetch"

import { i18nConfig } from "@/i18n/i18nConfig"

import Base from "@/layouts/Base.astro"
import BlogSingle from "@/layouts/BlogSingle.astro"

export async function getStaticPaths() {
  const { defaultLocale } = i18nConfig

  const posts = await sanityFetch({ type: "course", lang: defaultLocale, pipe: "order(_createdAt desc)" })

  const paths = posts.map((post: any) => ({
    params: {
      single: post.slug.current
    },
    props: { post, lang: defaultLocale }
  }))
  return paths
}

const { post, lang } = Astro.props
const { title, description, image } = post
---

<Base title={title} description={description} metaImage={image} lang={lang}>
  <BlogSingle post={post} />
</Base>
