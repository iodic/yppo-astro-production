---
import {
  handleAuthCallback,
  getClientId,
  getClientSecret,
  getRedirectUri,
  getTokenUri,
  getBaseUri,
} from "@/helper/auth";

const clientId = getClientId();
const clientSecret = getClientSecret();
const redirectUri = getRedirectUri();
const tokenUri = getTokenUri();
---

<!doctype html>
<html>
  <head>
    <title>OAuth Callback Handler</title>
  </head>
  <body>
    <input type="hidden" id="clientId" value={clientId} />
    <input type="hidden" id="clientSecret" value={clientSecret} />
    <input type="hidden" id="redirectUri" value={redirectUri} />
    <input type="hidden" id="tokenUri" value={tokenUri} />

    <script type="module">
      const clientId = document.getElementById("clientId").value;
      const clientSecret = document.getElementById("clientSecret").value;
      const redirectUri = document.getElementById("redirectUri").value;
      const tokenUri = document.getElementById("tokenUri").value;

      if (window.location.search.includes("code=")) {
        handleAuthCallback(clientId, clientSecret, redirectUri, tokenUri);
      }
    </script>
  </body>
</html>
