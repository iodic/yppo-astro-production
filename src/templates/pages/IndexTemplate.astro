---
import { sanityFetch } from "@/utils/sanityFetch"

import Banner from "@/layouts/components/Banner.astro"
import KeyFeatures from "@/layouts/components/KeyFeatures.astro"
import Testimonial from "@/layouts/components/Testimonial.astro"
import CtaSanity from "@/partials/CtaSanity.astro"

const { lang } = Astro.props

const homepageData = await sanityFetch(
  "homepage",
  lang,
  "en",
  `{
      title,
      heroSection {
        ...,
        videoCard {
          ...,
          "videoPoster": videoPoster.asset->url
        }
      },
      cardsSection,
      reviewsSection {
        ...,
        cards[] {
          ...,
          "image": image.asset->url,
        }
      },
      ctaBanner
  }`
)

const { title, heroSection, cardsSection, reviewsSection, ctaBanner } = homepageData[0] || {}
---

<>
  <!-- banner -->
  <Banner banner={heroSection} />
  <!-- key features -->
  <KeyFeatures cardsData={cardsSection} />
  <!-- testimonial -->
  <Testimonial testimonialsData={reviewsSection} />
  <!-- call to action -->
  <CtaSanity ctaBanner={ctaBanner} />
</>
