---
import { sanityFetch } from "@/lib/utils/sanityFetch"

import Banner from "@/layouts/components/Banner.astro"
import KeyFeatures from "@/layouts/components/KeyFeatures.astro"
import Testimonial from "@/layouts/components/Testimonial.astro"
import Cta from "@/partials/Cta.astro"

const { lang } = Astro.props

const homepageData = await sanityFetch({
  type: "homepage",
  lang,
  object: `{
      title,
      heroSection {
        ...,
        videoCard {
          ...,
          "videoPoster": videoPoster.asset->url
        }
      },
      cardsSection,
      reviewsSection {
        ...,
        cards[] {
          ...,
          "image": image.asset->url,
        }
      },
      ctaBanner
  }`
})

const { title, heroSection, cardsSection, reviewsSection, ctaBanner } = homepageData[0] || {}
---

<>
  <!-- banner -->
  <Banner banner={heroSection} />
  <!-- key features -->
  <KeyFeatures cardsData={cardsSection} />
  <!-- testimonial -->
  <Testimonial testimonialsData={reviewsSection} />
  <!-- call to action -->
  <Cta ctaBanner={ctaBanner} />
</>
