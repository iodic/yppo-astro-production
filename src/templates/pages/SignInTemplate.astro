---
import { sanityFetch } from "@/lib/utils/sanityFetch"

import Base from "@/layouts/Base.astro"
import SigninSlider from "@/layouts/function-components/SigninSlider.jsx"

const { lang } = Astro.props

const signInPageData = await sanityFetch({
  type: "signInPage",
  lang,
  object: `{
    title,
    description,
    pageMetadata {
      ...,
      "metaImage": metaImage.asset->url,
    },
    googleSignInText,
    emailSignInText,
    emailObject,
    passwordObject,
    buttonString,
    signInSliderContent,
    cantLoginText,
    signupText,
    "signInImage": signInImage.asset->url,
  }`
})

const {
  title,
  description,
  pageMetadata,
  signInImage,
  googleSignInText,
  emailSignInText,
  emailObject,
  passwordObject,
  buttonString,
  signInSliderContent,
  cantLoginText,
  signupText
} = signInPageData[0] || {}

const { metaTitle, metaDescription, metaImage, noIndex, canonicalUrl } = pageMetadata || {}
---

<Base
  title={title && title}
  metaTitle={metaTitle && metaTitle}
  description={metaDescription && metaDescription}
  metaImage={metaImage && metaImage}
  noIndex={noIndex && noIndex}
  canonical={canonicalUrl && canonicalUrl}
  lang={lang}
>
  <section>
    <div class="container max-w-full">
      <div class="row">
        <div class="min-h-[980px] bg-white py-10 lg:col-6 lg:py-[114px]">
          <div class="mx-auto w-full max-w-[480px]">
            {signInImage && <img class="mb-8 w-20" alt="service" src={signInImage} />}
            {title && <h1 class="mb-4">{title}</h1>}
            {description && <p> {description}</p>}
            {
              googleSignInText && (
                <div class="signin-options mt-10">
                  <a class="btn btn-outline-white block w-full text-dark" href="#">
                    {googleSignInText}
                  </a>
                </div>
              )
            }
            {
              emailSignInText && (
                <div class="relative my-8 text-center after:absolute after:left-0 after:top-1/2 after:z-[0] after:w-full after:border-b after:border-border after:content-['']">
                  <span class="relative z-[1] inline-block bg-white px-2">{emailSignInText}</span>
                </div>
              )
            }

            <form action="#">
              <div class="form-group">
                <label for="email" class="form-label">{emailObject?.fieldName}</label>
                <input type="email" id="email" class="form-control" placeholder={emailObject?.placeholder} />
              </div>
              <div class="form-group mt-4">
                <label for="password" class="form-label">{passwordObject?.fieldName}</label>
                <input type="password" id="password" class="form-control" placeholder={passwordObject?.placeholder} />
              </div>
              <input class="btn btn-primary mt-10 block w-full" type="submit" value={buttonString} />
              <p class="mt-6 text-center">
                {cantLoginText}
                <a href="/login" class="text-dark">log in</a>?
                <a class="text-dark" href="/signup">Sign up</a>
                {signupText}
              </p>
            </form>
          </div>
        </div>

        <SigninSlider client:load title={signInSliderContent?.title} />
      </div>
    </div>
  </section>
</Base>
